steps:
- task: InstallAppleCertificate@2
  displayName: 'Install Certificates'
  inputs:
    certSecureFile: 'Certificates.p12' 
    certPwd: '$(P12password)'
    keychain: 'temp'

- task: InstallAppleProvisioningProfile@1
  displayName: 'Install Provisioning Profile'
  inputs:
    provisioningProfileLocation: 'secureFiles'
    provProfileSecureFile: 'iOS_Team_Provisioning_Profile.mobileprovision'

- task: CocoaPods@0
  displayName: 'Installing dependency via pod'
  inputs:
    workingDirectory: 'source/ios/AdaptiveCards'
    forceRepoUpdate: false

- task: Xcode@5
  displayName: 'Compiling...'
  inputs:
    actions: 'build'
    xcWorkspacePath: 'source/ios/AdaptiveCards/AdaptiveCards.xcworkspace'
    scheme: 'ADCIOSVisualizer'
    xcodeVersion: 'default'
    signingOption: 'manual'
    signingIdentity: '$(APPLE_CERTIFICATE_SIGNING_IDENTITY)'
    provisioningProfileUuid: '$(APPLE_PROV_PROFILE_UUID)'
    useXcpretty: false,
    sdk: iphoneos
    packageApp: true
    configuration: Release
    destinationPlatformOption: 'iOS'
    destinationSimulators: 'iPhone 12'
